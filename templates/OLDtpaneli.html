<!DOCTYPE html>
<html>
<head>
    <title>Test panel</title>
    <script src="zepto.min.js"></script>
    <script src="underscore-min.js"></script>
    <link href="bulma.min.css" rel="stylesheet" type="text/css" > 
    <link href="bulma-switch.min.css" rel="stylesheet" type="text/css" >
    <!--    <link href="/static/style.css" rel="stylesheet" type="text/css" > -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<style>
#dropdown_control {
    width: 100%;
    width: 400px;
}
</style>
</head>
<body>

    <div id="control_panel" class="container is-fluid">
    <div class="columns">
      <div class="column">
        <div class="dropdown"  >
          <div class="dropdown-trigger" id="select_presentation_drop">
            <button id="dropdown_control" class="button">
              <span id="selected_presentation">Select a presentation...</span>
              <span class="icon is-small">
                <i class="fas fa-angle-down" aria-hidden="true"></i>
              </span>
            </button>
          </div>
        
          <div class="dropdown-menu" id="dropdown-menu" role="menu">
            <div class="dropdown-content">
              <a href="#" class="dropdown-item" data-path="some_path_here_man">
                Dropdown item
              </a>
              <a class="dropdown-item">
                Other dropdown item
              </a>
              <a href="#" class="dropdown-item">
                Active dropdown item let's use a very
              </a>
              <a href="#" class="dropdown-item">
                Other dropdown item
              </a>
              <hr class="dropdown-divider">
              <a href="#" class="dropdown-item">
                With a divider
              </a>
            </div>
          </div>
        </div>

        <div class="level">
            <div class="column is-half">
                <button id="start_presentation" class="button is-primary is-small" disabled>Start Presentation</button>
            </div>
            <div class="column">
                <button id="finish_presentation" class="button is-primary is-small" disabled>Finish Presentation</button>
            </div>
        </div> <!-- close level -->
      </div>

      <div class="column">
            <input id="lock_student_nav" class="switch is-rounded is-small" type="checkbox" checked>
            <label for="lock_student_nav">Lock Student Navigation</label>

            <input id="lock_follow_instructor" class="switch is-rounded is-small" type="checkbox" checked>
            <label for="lock_follow_instructor">Lock Follow Me</label>

            <button id="sync_to_me" class="button is-primary is-small" disabled>Sync All with Me</button>
      </div> <!-- close column -->

      <div class="column">
        <button id="force_i_submission"  class="button is-primary is-small" disabled>Force Interaction Submission</button>
        <button id="see_interaction_results"  class="button is-primary is-small" disabled>See Interaction Results</button>
      </div> <!-- close column -->


    </div>
    </div>

<script>
Zepto(function($){

var selected_pres = null;
var path = null;

$('#dropdown_control').on('click', function(ev) {
    $('.dropdown').toggleClass('is-active');
});

$('.dropdown-item').on('click', function(ev) {
    $('.dropdown').removeClass('is-active');
    selected_pres = $(ev.target).text().trim();
    $('#selected_presentation').text(selected_pres);
    $('#start_presentation').removeAttr("disabled");
    $('#finish_presentation').attr("disabled");
    path = $(ev.target).attr("data-path");
    /*
    ev.target.setAttribute("disabled","true");
    $('#finish_presentation').removeAttr("disabled");
    var path = $("#available_pres").val();
    ILTRevealSession.sendreq_start_presentation(path);
    */
});

$('#start_presentation').on('click', function(ev) {

    $(ev.target).attr("disabled", true);
    $('#dropdown_control').attr("disabled", true);

    $('#finish_presentation').removeAttr("disabled");
    console.log('starting presentation ' + path);
//    var path = $(ev.target).attr('data-path');
    ILTRevealSession.sendreq_start_presentation(path);
});

$('#lock_student_nav').on('click', function(ev) {
    ILTRevealSession.sendreq_lock_student_nav(ev.target.checked);
});
$('#lock_follow_instructor').on('click', function(ev) {
    ILTRevealSession.sendreq_lock_follow_instructor(ev.target.checked);
});

$('#sync_to_me').on('click', function(ev) {
    ILTRevealSession.sendreq_sync_to_instructor();
});

$('#force_i_submission').on('click', function(ev) {
    ILTRevealSession.sendreq_force_interaction_submission();
});

$('#see_interaction_results').on('click', function(ev) {
    ILTRevealSession.sendreq_see_interaction_results();
});

$('#finish_presentation').on('click', function(ev) {
    if (!window.confirm("Do you really want to finish the presentation?")) { 
        return;
    }
    ev.target.setAttribute("disabled", "true");
    $('#selected_presentation').text('Select a presentation...');
    //$('#start_presentation').removeAttr("disabled");
    $('#dropdown_control').removeAttr("disabled");
    ILTRevealSession.sendreq_finish_presentation();
});

});
</script>
</body>
</html>
